apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: logscale-${logscale_name}-lsc
  namespace: ${logscale_namespace}
spec:
  interval: 10m
  timeout: 5m
  chart:
    spec:
      chart: logscale-collector
      version: "1.2.1"
      sourceRef:
        kind: HelmRepository
        name: crowdstrike-lsc
        namespace: flux-repos
      interval: 5m
  releaseName: logscale-${logscale_name}-lsc
  install:
    remediation:
      retries: 3
  upgrade:
    remediation:
      retries: 3
  test:
    enable: false
  driftDetection:
    mode: warn
  dependsOn:
    - name: logscale
    - name: logscale-content-ref-lsc-infra-kubernetes
  values:
    imagePullPolicy: IfNotPresent
    humioAddress: https://ingest-logscale.team.pub.logsr.life
    humioIngestTokenSecretName: ingest-token-ref-lsc-infra-kubernetes
    # humioIngestTokenSecretKey:
    humioDebugTokenSecretName: ingest-token-ref-lsc-debug-lsc
    # humioDebugTokenSecretKey:
    collectJournal: true
